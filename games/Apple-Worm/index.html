<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html; charset=UTF8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="#382C2A">
	<meta name="viewport"
		content="height=device-height, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" />
	<title>Apple Worm - Nimo</title>

	<script type="text/javascript" src="//game-cdn.poki.com/scripts/v2/poki-sdk.js"></script>
	<script type="text/javascript" src="./js/loader.js"></script>
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		html, body {
			margin: 0;
			padding: 0;
			overflow: hidden;
			width: 100%;
			height: 100%;
			background-color: #3ce1ff;
		}

		#splash__image {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: #3ce1ff;
			z-index: 10000;
		}

		#splash__image::before {
			content: '';
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-image: url('assets/preloader.jpg');
			background-size: cover;
			background-size: 100% 100%;
			background-repeat: no-repeat;
		}

		#progress__root {
			position: absolute;
			width: 80%;
			height: 20px;
			top: 85%;
			left: 10%;
			background-color: rgba(255, 255, 255, 0.8);
			border-radius: 10px;
			overflow: hidden;
			border: 2px solid #333;
			z-index: 10001;
		}

		#progress__line {
			width: 0%;
			height: 100%;
			background-color: #a24f17;
			transition: width 0.3s ease;
			border-radius: 8px;
		}
	</style>
</head>

<body>
	<div id="splash__image">
		<div id="progress__root">
			<div id="progress__line"></div>
		</div>
	</div>

	<script>
		window.addEventListener("load", () => {
			PokiSDK.init().then(
				() => {
					onPokiInitComplete(false);
				}
			).catch(
				() => {
					onPokiInitComplete(true);
				}
			);

			let config = {
				"key": "Apple Worm-ScreenResize",
				"title": "Apple Worm Screen Resize",
				"filename": "apple-worm-18130bbad-Unlocked-ScreenResize",
				"pokiSDK": true,
				"debugPoki": true,
				"showFPS": false,
				"debug": false,
				"splash": "assets/preloader.jpg",
				"start": null,
				"width": 500,
				"height": 374,
				"x": 0,
				"y": 0,
				"w": "100%",
				"h": "100%",
				"stageScaleMode": null,
				"stageAlign": null,
				"progressParserWeigth": 0.5,
				"progress": {
					"direction": "lr",
					"back": "#fff",
					"line": "#a24f17",
					"rect": [0.1, 0.85, 0.8, 0.025]
				},
				"skipFramesOfScene": null,
				"buttonPokiSDKActions": null,
				"retryButtonIDS": null,
				"retryButtonAction": null,
				"actionOnStop": null,
				"actionWhenRetryButtonEncountered": null,
				"debugpoki": false,
				"binary": [
					{
						"name": "fonts.swf",
						"path": "assets/fonts.swf",
						"size": 30506
					},
					{
						"name": "apple-worm-18130bbad-Unlocked-ScreenResize",
						"path": "assets/apple-worm-18130bbad-Unlocked-ScreenResize.swf",
						"size": 4427222,
						"resourceType": "GAME"
					}
				],
				"runtime": "js/Main.js"
			};
			
			PokiSDK.setDebug(config.debugPoki);
			Loader.init(config);

			let onPokiInitComplete = (adBlocked) => {
				PokiSDK.adBlocked = adBlocked;
				PokiSDK.gameLoadingStart();

				Loader.runGame((fill) => {
					const progressLine = document.getElementById('progress__line');
					if (progressLine) {
						progressLine.style.width = (fill * 100) + '%';
					}
					
					PokiSDK.gameLoadingProgress({
						percentageDone: fill,
						kbLoaded: 0,
						kbTotal: 0,
						fileNameLoaded: "",
						filesLoaded: 0,
						filesTotal: 0
					});
				}, (instance) => {
					const splash = document.getElementById('splash__image');
					if (splash) {
						splash.style.display = 'none';
					}
					
					PokiSDK.gameLoadingFinished();
				})
			}
		});
	</script>
</body>
</html>